# ============================================
# APPLICATION.PROPERTIES - CONFIGURAÇÃO ATUALIZADA
# Sistema Figurama - Gerenciamento de Coleções
# ============================================

# ========================================
# CONFIGURAÇÃO DO MYSQL
# ========================================

# URL de conexão com MySQL
# Timezone ajustado para America/Fortaleza
spring.datasource.url=jdbc:mysql://localhost:3306/figurama_db?useSSL=false&serverTimezone=America/Fortaleza&allowPublicKeyRetrieval=true&createDatabaseIfNotExist=true

# Credenciais do banco de dados
spring.datasource.username=figurama_user
spring.datasource.password=figurama123

# Driver JDBC do MySQL
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Pool de conexões HikariCP (otimização)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000

# ========================================
# CONFIGURAÇÃO DO JPA/HIBERNATE
# ========================================

# Dialeto do MySQL 8
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# Estratégia de DDL
# update = atualiza schema sem apagar dados (RECOMENDADO para desenvolvimento)
# validate = apenas valida o schema (RECOMENDADO para produção)
# create = recria tabelas (CUIDADO: apaga todos os dados!)
# create-drop = cria e apaga ao fechar aplicação (útil para testes)
spring.jpa.hibernate.ddl-auto=update

# Mostrar SQL executado no console (debug)
spring.jpa.show-sql=true

# Formatar SQL para melhor legibilidade
spring.jpa.properties.hibernate.format_sql=true

# Adicionar comentários no SQL gerado
spring.jpa.properties.hibernate.use_sql_comments=true

# Mostrar valores dos parâmetros SQL (bind parameters)
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Otimizações do Hibernate
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Estratégia de nomeação (snake_case)
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# ========================================
# CONFIGURAÇÃO DO SERVIDOR
# ========================================

# Porta do servidor
server.port=8080

# Context path (opcional - descomente se quiser um prefixo)
# server.servlet.context-path=/figurama

# Timeout de sessão (30 minutos)
server.servlet.session.timeout=30m

# Compressão de resposta (melhor performance)
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# ========================================
# ENCODING E INTERNACIONALIZAÇÃO
# ========================================

# Garantir UTF-8 em toda aplicação
spring.mandatory-file-encoding=UTF-8
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true

# Locale padrão (Brasil)
spring.web.locale=pt_BR
spring.web.locale-resolver=fixed

# ========================================
# UPLOAD DE ARQUIVOS
# ========================================

# Habilitar multipart
spring.servlet.multipart.enabled=true

# Tamanho máximo por arquivo (5MB)
spring.servlet.multipart.max-file-size=5MB

# Tamanho máximo da requisição total (10MB)
spring.servlet.multipart.max-request-size=10MB

# Threshold para escrita em disco (2KB)
spring.servlet.multipart.file-size-threshold=2KB

# Diretório de armazenamento de imagens
file.upload-dir=uploads

# ========================================
# CONFIGURAÇÃO DE CORS
# ========================================

# Permitir requisições de outras origens (necessário para frontend)
# Em produção, especifique domínios exatos
spring.web.cors.allowed-origins=http://localhost:8000,http://localhost:3000,http://127.0.0.1:8000
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true
spring.web.cors.max-age=3600

# ========================================
# CONFIGURAÇÃO DE LOGGING
# ========================================

# Nível de log geral
logging.level.root=INFO

# Log da aplicação Figurama
logging.level.com.ajm.figurama=DEBUG

# Log do Spring Framework
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=DEBUG

# Log do Hibernate
logging.level.org.hibernate=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type=TRACE

# Padrão de log no console
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Arquivo de log (opcional)
# logging.file.name=logs/figurama.log
# logging.file.max-size=10MB
# logging.file.max-history=30

# ========================================
# CONFIGURAÇÃO DE ERROS
# ========================================

# Incluir detalhes de erro nas respostas
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# Página de erro customizada (opcional)
# server.error.whitelabel.enabled=false

# ========================================
# CONFIGURAÇÃO DE CACHE
# ========================================

# Desabilitar cache em desenvolvimento
spring.web.resources.cache.period=0
spring.web.resources.chain.cache=false

# Cache de templates Thymeleaf (se usar)
spring.thymeleaf.cache=false

# ========================================
# CONFIGURAÇÃO DE SEGURANÇA (TEMPORÁRIO)
# ========================================

# Desabilitar segurança padrão do Spring Boot
# REMOVER EM PRODUÇÃO E IMPLEMENTAR SEGURANÇA ADEQUADA
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

# ========================================
# CONFIGURAÇÃO DE JACKSON (JSON)
# ========================================

# Formato de datas JSON
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=America/Fortaleza

# Ignorar propriedades desconhecidas no JSON
spring.jackson.deserialization.fail-on-unknown-properties=false

# Incluir apenas propriedades não nulas
spring.jackson.default-property-inclusion=non_null

# Indentação do JSON (desenvolvimento)
spring.jackson.serialization.indent_output=true

# ========================================
# CONFIGURAÇÃO DE VALIDAÇÃO
# ========================================

# Validação de beans
spring.validation.enabled=true

# ========================================
# CONFIGURAÇÃO DE PERFIS
# ========================================

# Perfil ativo (dev, prod, test)
spring.profiles.active=dev

# ========================================
# CONFIGURAÇÕES ESPECÍFICAS DO FIGURAMA
# ========================================

# Caminho base para imagens (URLs públicas)
figurama.images.base-url=http://localhost:8080/uploads

# Extensões de imagem permitidas
figurama.images.allowed-extensions=jpg,jpeg,png,gif,webp

# Máximo de coleções por usuário (0 = ilimitado)
figurama.user.max-collections=0

# Máximo de itens por coleção (0 = ilimitado)
figurama.collection.max-items=0

# ========================================
# CONFIGURAÇÕES DE DESENVOLVIMENTO
# ========================================

# Recarregar automáticamente (DevTools)
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true

# Excluir da reinicialização
spring.devtools.restart.exclude=static/**,public/**,uploads/**

# ========================================
# CONFIGURAÇÕES DE BANCO (AVANÇADO)
# ========================================

# Inicialização do banco
spring.sql.init.mode=never
spring.sql.init.platform=mysql

# Schema e dados iniciais (se necessário)
# spring.sql.init.schema-locations=classpath:schema.sql
# spring.sql.init.data-locations=classpath:data.sql

# ========================================
# INFORMAÇÕES DA APLICAÇÃO
# ========================================

# Metadados da aplicação
spring.application.name=Figurama
info.app.name=Figurama - Sistema de Coleções
info.app.description=Gerenciamento de Coleções de Action Figures
info.app.version=1.0.0
info.app.encoding=${spring.mandatory-file-encoding}
info.app.java.version=${java.version}

# ========================================
# NOTAS IMPORTANTES
# ========================================

# 1. Para PRODUÇÃO, altere:
#    - spring.jpa.hibernate.ddl-auto=validate
#    - spring.jpa.show-sql=false
#    - spring.profiles.active=prod
#    - Remover autoconfigure.exclude de Security
#    - Configurar HTTPS
#    - Especificar CORS allowed-origins exatos
#
# 2. Criar usuário MySQL:
#    CREATE USER 'figurama_user'@'localhost' IDENTIFIED BY 'figurama123';
#    GRANT ALL PRIVILEGES ON figurama_db.* TO 'figurama_user'@'localhost';
#    FLUSH PRIVILEGES;
#
# 3. Certifique-se de que a pasta 'uploads/' existe e tem permissões de escrita
#
# 4. O timezone está configurado para America/Fortaleza (UTC-3)
#    Ajuste conforme necessário para sua região