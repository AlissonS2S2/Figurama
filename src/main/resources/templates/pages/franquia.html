<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../css/components/buttons.css">
    <link rel="stylesheet" href="../css/components/cards.css">
    <link rel="stylesheet" href="../css/components/forms.css">
    <link rel="stylesheet" href="../css/pages/franquia.css">
</head>
<body>
    <header class="header-logged">
        <a href="dashboard.html">
            <img class="logo" src="../images/Logo.png" alt="Logo Figurama">
        </a>
        
        <nav class="nav-logged">
            <span>
                <img class="profile-icon" src="../icons/Profile-icon.png" alt="Descrição da imagem">N_Usuário</span>
            <a href="#">Coleção</a>
            <input type="text" placeholder="Pesquisar">
            <button class="btn-add">Adicionar +</button>
        </nav>
    </header>

    <main class="franchise-container">
        <section class="franchise-info">
            <h1 id="franchise-title"></h1>
            <p id="franchise-description"></p>
            <small id="total-figures"> Action Figures nessa franquia</small>
            <hr>
        </section>

        <section class="cards-franchise" id="figures-grid">
            <!-- Cards serão inseridos aqui pelo JavaScript -->
        </section>
    </main>

    <script>
        const API_BASE_URL = 'http://localhost:3000/api';

function getFranchiseId() {
    const params = new URLSearchParams(window.location.search);
    return params.get('id');
}

async function loadFranchiseInfo() {
    const franchiseId = getFranchiseId();
    
    if (!franchiseId) {
        console.error('ID da franquia não encontrado');
        return;
    }

    try {
        const response = await fetch(`${API_BASE_URL}/franchises/${franchiseId}`);
        const data = await response.json();

        if (response.ok) {
            document.getElementById('franchise-title').textContent = `Franquia - ${data.nome}`;
            document.getElementById('franchise-description').textContent = data.descricao;
            document.getElementById('total-figures').textContent = 
                `${data.total_figures} Action Figures nessa coleção (oficial)`;
        }
    } catch (error) {
        console.error('Erro ao carregar informações da franquia:', error);
    }
}


async function loadFranchiseFigures() {
    const franchiseId = getFranchiseId();
    
    if (!franchiseId) return;

    try {
        const response = await fetch(`${API_BASE_URL}/franchises/${franchiseId}/figures`);
        const figures = await response.json();
        const grid = document.getElementById('figures-grid');
        grid.innerHTML = '';

        figures.forEach(figure => {
            const card = document.createElement('div');
            card.className = 'figure-card';
            card.onclick = () => window.location.href = `detail.html?id=${figure.id}`;
            
            card.innerHTML = `
                <div class="figure-card-image">
                    <img src="${figure.imagem_url}" alt="${figure.nome}">
                </div>
                <div class="figure-card-info">
                    <p class="figure-card-name">${figure.nome}</p>
                </div>
            `;
            
            grid.appendChild(card);
        });
    } catch (error) {
        console.error('Erro ao carregar figuras da franquia:', error);
    }
}

document.addEventListener('DOMContentLoaded', () => {
    loadFranchiseInfo();
    loadFranchiseFigures();
});
    </script>
    
</body>
</html>